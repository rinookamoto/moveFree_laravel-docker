### 詳細設計　(イベント/ロジック処理)　 P-02:Login

## 開発メモ

実装用ファイル構成 (Laravel Breeze 標準)
実装時は以下のファイル群を使用・編集することになります。
Controller: app/Http/Controllers/Auth/AuthenticatedSessionController.php
View: resources/views/auth/login.blade.php
Route: routes/auth.php (Breeze 導入時に自動生成)

1. 画面概要
   登録済みのユーザーがシステムにアクセスするための認証画面です。
   | 項目 | 内容 |
   | :------ | :----------------------------------------------------- |
   | 画面名 | ログイン |
   | パス（URL） | /login |
   | アクセス権限 | ゲスト（未ログインユーザー）のみ |
   | 主な構成要素 | メールアドレス入力欄、パスワード入力欄、ログイン保持チェックボックス、ログインボタン、会員登録画面へのリンク |

2. イベント処理詳細 (Event Handling)

| 発生タイミング       | アクション（Laravel 実装）            | HTTP メソッド | ルート名 | 処理内容詳細                                                                                                                           | 遷移先     |
| :------------------- | :------------------------------------ | :------------ | :------- | :------------------------------------------------------------------------------------------------------------------------------------- | :--------- |
| 画面表示時           | AuthenticatedSessionController@create | GET           | login    | 1. auth.login ビューを表示する。                                                                                                       | 自画面     |
| ログインボタン押下   | AuthenticatedSessionController@store  | POST          | login    | 1. 送信された email, password を取得する。<br>2. ログインバリデーション（L-01）を実行する。<br>3. 認証成功時にセッションを再生成する。 | P-04：DB   |
| 登録画面へリンク押下 | リンククリック                        | GET           | register | 1. 新規登録画面を表示する。                                                                                                            | P-03：登録 |

3. ロジック処理詳細 (Logic Processing)
   | 処理 ID | 処理名 | 実装内容詳細 | 関連テーブル |
   | :--- | :-------- | :---------------------------------------------------------------------------------------------------------- | :----- |
   | L-01 | 認証バリデーション | 1. email：必須入力、email 形式、users テーブルに存在することを確認する。<br>2. password：必須入力。<br>3. 認証失敗時はエラーメッセージを付与し、ログイン画面へリダイレクトする。 | users |
   | L-02 | セッション管理 | 1. Auth::attempt により認証処理を実行する。<br>2. 認証成功後に session()->regenerate() を実行し、セッション固定攻撃（Session Fixation）を防止する。 | - |

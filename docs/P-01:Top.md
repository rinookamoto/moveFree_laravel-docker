### 詳細設計　(イベント/ロジック処理)　 P-01: Top

## 開発メモ

プログラム実装へのガイド（Laravel 12）
この設計を実装する際は、以下の構成を作成します。
Controller: app/Http/Controllers/PostController.php
Method: public function index()
Route: routes/web.php 内で Route::get('/', [PostController::class, 'index'])->name('posts.index');
View: resources/views/posts/index.blade.php (カード形式のレイアウトを実装)

1. 画面概要
   全ユーザーがアクセス可能な記事一覧画面です 。
   ログイン状態に応じて、ヘッダーのナビゲーション（ログイン・登録 または ダッシュボード）が動的に切り替わります。
   | 項目 | 内容 |
   | :------ | :--------------------------------------------------------- |
   | 画面名 | トップ画面 |
   | パス（URL） | / |
   | アクセス権限 | 制限なし（ゲスト・ログイン済みユーザーともに閲覧可能） |
   | 主な構成要素 | サービスロゴ、ナビゲーション（ログイン・登録 または ダッシュボード）、最新記事一覧（カード形式）、ページネーション |

2. イベント処理詳細 (Event Handling)

| 発生タイミング           | アクション           | HTTP メソッド | ルート名    | 処理内容                                                                                                                                                                 | 遷移先               |
| :----------------------- | :------------------- | :------------ | :---------- | :----------------------------------------------------------------------------------------------------------------------------------------------------------------------- | :------------------- |
| 画面表示時               | PostController@index | GET           | posts.index | 1. Post モデルから全記事を最新順（latest()）で取得する。<br>2. 1 ページあたり 10 件のページネーションを実施する。<br>3. top.blade.php へデータを渡してレンダリングする。 | 自画面（/）          |
| ログインボタン押下       | リンククリック       | GET           | login       | 1. Laravel Breeze 標準のログイン画面を表示する。                                                                                                                         | P-02：ログイン       |
| 会員登録ボタン押下       | リンククリック       | GET           | register    | 1. Laravel Breeze 標準の会員登録画面を表示する。                                                                                                                         | P-03：会員登録       |
| 記事タイトル押下         | リンククリック       | GET           | posts.show  | 1. クリックされた記事 ID をパラメータとして送信する。<br>2. 該当記事の個別データを取得する。                                                                             | P-05：記事詳細       |
| ダッシュボードボタン押下 | リンククリック       | GET           | dashboard   | 1. ログイン済みユーザーのみ表示する。<br>2. 認証済みユーザー専用の管理画面へ遷移する。                                                                                   | P-04：ダッシュボード |

3. ロジック処理詳細 (Logic Processing)
   | 処理 ID | 処理名 | 実装内容詳細 | 関連 DB テーブル |
   | :--- | :-------- | :------------------------------------------------------------------------------------------ | :----------- |
   | L-01 | 最新記事一覧取得 | Post::with('user')->latest()->paginate(10) を実行し、投稿者（user）情報を Eager Loading した記事一覧を取得する。 | posts, users |
   | L-02 | 認証ステータス判定 | Blade の @auth ディレクティブを使用し、セッション情報を基に認証状態を判定する。ゲストには「ログイン・登録」、認証済みユーザーには「ダッシュボード・ログアウト」を表示する。 | セッション |
   | L-03 | 文字列切り出し処理 | 記事本文（body）が一定文字数を超える場合、Str::limit() を使用してトップ画面表示用の抜粋テキストを生成する。 | posts |
